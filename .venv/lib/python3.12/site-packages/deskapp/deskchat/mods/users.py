from typing import Any, List

from deskapp.deskchat.client import manager as client


NAME = 'Users'


def init(app: Any):
    # users list is filled via client subscription
    pass


def draw(app: Any, win, h: int, w: int):
    users: List[str] = app.data.get('users', []) or []

    if not client.is_connected():
        win.addstr(1, 2, 'Login to see the users list.')
        return

    if not users:
        win.addstr(1, 2, 'Logged in. Waiting for users list...')
        return

    win.addstr(1, 2, f"{len(users)} users:")
    y = 3
    for u in users:
        if y >= h - 2:
            break
        win.addstr(y, 4, f"- {u}")
        y += 1
